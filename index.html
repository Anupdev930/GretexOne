<!DOCTYPE html>
<html>
<head>
Â  <base target="_top">
  <title>Gretex One - Login</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â Â 
Â  <style>
Â  Â  /* All your CSS styles are unchanged... */
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
Â  Â  * { margin: 0; padding: 0; box-sizing: border-box; }
Â  Â  body {
Â  Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  Â  background: #f0f4f8;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  color: #333;
Â  Â  }
Â  Â  #main-content { width: 100%; }
Â  Â  #login-container {
Â  Â  Â  display: flex;
Â  Â  Â  width: 900px;
Â  Â  Â  max-width: 90%;
Â  Â  Â  margin: 20px;
Â  Â  Â  background: #ffffff;
Â  Â  Â  border-radius: 20px;
Â  Â  Â  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
Â  Â  Â  overflow: hidden;
Â  Â  }
Â  Â  .login-panel-left {
Â  Â  Â  flex-basis: 40%;
Â  Â  Â  background: linear-gradient(135deg, #3b439c, #4a5a9b);
Â  Â  Â  color: white;
Â  Â  Â  padding: 60px 40px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  justify-content: center;
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  .login-panel-left h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 15px; }
Â  Â  .login-panel-left p { font-size: 1rem; color: rgba(255, 255, 255, 0.8); line-height: 1.6; }
Â  Â  .login-panel-right {
Â  Â  Â  flex-basis: 60%;
Â  Â  Â  padding: 60px 50px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  justify-content: center;
Â  Â  }
Â  Â  .login-panel-right h2 { font-size: 2rem; font-weight: 600; color: #333; margin-bottom: 10px; }
Â  Â  .login-panel-right h2 span { font-size: 1.5rem; }
Â  Â  .login-panel-right p { color: #777; margin-bottom: 30px; font-size: 1rem; }
Â  Â  #login-form label { font-size: 0.9rem; font-weight: 500; color: #555; margin-bottom: 8px; display: block; }
Â  Â  #login-form input[type="text"],
Â  Â  #login-form input[type="password"] {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 14px 18px;
Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  font-size: 1rem;
Â  Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  transition: border-color 0.3s;
Â  Â  }
Â  Â  #login-form input:focus { outline: none; border-color: #4a5a9b; }
Â  Â  #login-button {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 15px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  background: #4a5a9b;
Â  Â  Â  color: white;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  font-weight: 600;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background-color 0.3s;
Â  Â  }
Â  Â  #login-button:hover { background: #3b439c; }
Â  Â  #login-button:disabled { background: #ccc; cursor: not-allowed; }
Â  Â  .forgot-password { display: block; text-align: center; margin-top: 20px; color: #777; text-decoration: none; font-size: 0.9rem; }
Â  Â  .forgot-password:hover { text-decoration: underline; }
Â  Â  #message { text-align: center; margin-top: 15px; font-size: 0.9rem; }
Â  Â  .loading-message { color: #555; }
Â  Â  .error-message { color: #d93025; font-weight: 500; }
Â  Â  .hidden { display: none; }
Â  </style>
</head>

<body>
Â  <div id="main-content">
Â  Â  <div id="login-container">
Â  Â  Â  <div class="login-panel-left">
Â  Â  Â  Â  <h1>Gretex One</h1>
Â  Â  Â  Â  <p>A secure space to manage all your applications and tasks effortlessly. Sign in to access your personalized dashboard.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="login-panel-right">
Â  Â  Â  Â  <h2>Welcome Back <span>ðŸ‘‹</span></h2>
Â  Â  Â  Â  <p>Please sign in to your account.</p>
Â  Â  Â  Â  <form id="login-form">
Â  Â  Â  Â  Â  <label for="userid">User ID</label>
Â  Â  Â  Â  Â  <input type="text" id="userid" name="userid" required>
Â  Â  Â  Â  Â  <label for="password">Password</label>
Â  Â  Â  Â  Â  <input type="password" id="password" name="password" required>
Â  Â  Â  Â  Â  <div id="message"></div>
Â  Â  Â  Â  Â  <button type="submit" id="login-button">Sign In</button>
Â  Â  Â  Â  Â  <a href="#" class="forgot-password">Forgot Password?</a>
Â  Â  Â  Â  </form>
Â  Â  Â  </div>
Â  Â  </div>
  </div> 
  
  <script>
    // ******* IMPORTANT *******
    // PASTE YOUR NEW APPS SCRIPT WEB APP URL HERE
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzJ509n_LiOwk6OUDckqIpsrH8tQWIZacpR5tpB1XYjRv6UjKAZYx2roFN8Q1clZd8Dqw/exec"; 
    // *************************

Â  Â  document.addEventListener("DOMContentLoaded", function() {
Â  Â  Â  const loginForm = document.getElementById("login-form");
      
      // Check if user is already logged in
      if (sessionStorage.getItem("gretexUser")) {
        window.location.href = "App_access.html"; // Redirect to dashboard
      }
Â  Â  Â Â 
Â  Â  Â  loginForm.addEventListener("submit", function(e) {
Â  Â  Â  Â  e.preventDefault(); 
Â  Â  Â  Â Â 
Â  Â  Â  Â  const loginButton = document.getElementById("login-button");
Â  Â  Â  Â  const messageDiv = document.getElementById("message");
Â  Â  Â  Â Â 
Â  Â  Â  Â  messageDiv.innerHTML = "Signing in...";
Â  Â  Â  Â  messageDiv.className = "loading-message";
Â  Â  Â  Â  loginButton.disabled = true;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Get data from the form
Â  Â  Â  Â  const credentials = {
Â  Â  Â  Â  Â  userId: document.getElementById("userid").value,
Â  Â  Â  Â  Â  password: document.getElementById("password").value
Â  Â  Â  Â  };
        
        // This is the data we will send to the API
        const requestData = {
          action: "userLogin",
          params: credentials
        };

        // ** NEW: Send data using fetch() **
Â  Â  Â  Â  fetch(SCRIPT_URL, {
          method: 'POST',
          // Note: Using 'text/plain' is a common workaround for simple Apps Script POSTs
          headers: { 'Content-Type': 'text/plain;charset=utf-8' }, 
          body: JSON.stringify(requestData)
        })
        .then(res => res.json()) // Parse the JSON response from Apps Script
        .then(response => {
          // This is our new "onLoginSuccess" logic
          if (response.status === "success") {
            // 1. Save user data to session
Â  Â  Â  Â  Â  Â  sessionStorage.setItem("gretexUser", JSON.stringify(response.data));
Â  Â  Â  Â  Â  Â  
            // 2. Redirect to the dashboard FILE
Â  Â  Â  Â  Â  Â  window.location.href = "App_access.html";
          } else {
            // Show the error message from the API
            messageDiv.innerHTML = response.data.message;
            messageDiv.className = "error-message";
            loginButton.disabled = false;
          }
        })
        .catch(error => {
          // This is our new "onLoginFailure" logic
          console.error("Fetch Error:", error);
          messageDiv.innerHTML = "Error: " + error.message;
          messageDiv.className = "error-message";
          loginButton.disabled = false;
        });
Â  Â  Â  }); 
Â  Â  });
Â  </script>

</body>
</html>
